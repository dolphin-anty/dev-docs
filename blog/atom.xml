<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://dolphinrucom.github.io/internal-docs/internal-docs/blog</id>
    <title>Dolphin Internal Docs Center Blog</title>
    <updated>2022-04-28T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://dolphinrucom.github.io/internal-docs/internal-docs/blog"/>
    <subtitle>Dolphin Internal Docs Center Blog</subtitle>
    <icon>https://dolphinrucom.github.io/internal-docs/internal-docs/img/favicon.ico</icon>
    <entry>
        <title type="html"><![CDATA[Перегрузка серверов у новых пользователей]]></title>
        <id>dolphin-bug-cache-folder</id>
        <link href="https://dolphinrucom.github.io/internal-docs/internal-docs/blog/dolphin-bug-cache-folder"/>
        <updated>2022-04-28T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Проблема у юзеров]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_mojV" id="проблема-у-юзеров">Проблема у юзеров<a class="hash-link" href="#проблема-у-юзеров" title="Direct link to heading">​</a></h2><p><a href="https://dolphin-ru-com.atlassian.net/jira/software/projects/DSS/boards/51?selectedIssue=DSS-295" target="_blank" rel="noopener noreferrer">https://dolphin-ru-com.atlassian.net/jira/software/projects/DSS/boards/51?selectedIssue=DSS-295</a></p><p>Новые пользователи после установки дельфина ловили бесконечный загруз сервера на 100%. Так, что было почти невозможно ничего делать.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="проблема-под-капотом">Проблема под капотом<a class="hash-link" href="#проблема-под-капотом" title="Direct link to heading">​</a></h2><p>У новых пользователей в обязательном порядке почти сразу после установки Dolphin стартует загрузка баз гео, которая скачивается <a href="https://github.com/dolphinrucom/fb-lists/releases/tag/v1" target="_blank" rel="noopener noreferrer">отсюда</a> и затем вгружается в БД сервера юзера.</p><p>Примечательно, что в сжатом виде файл гео базы около 6MB. В распакованном - около 96MB. А в конечном счете базу данных сервера кладется около 200 000 записей - стран, регионов, городов, таргетов поведения, интересов и демографических признаков. В общем всего того, что есть в самом фб при настройке таргетов.</p><p>То есть такой объем данных не может вгрузиться в БД за 1 минуту. И именно поэтому на время, пока данные вгружаются мы делаем следующий финт:</p><div class="codeBlockContainer_I0IT language-php theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-php codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$this</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token property" style="color:#36acaa">load</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">driver</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string single-quoted-string" style="color:#e3116c">'cache'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">array</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string single-quoted-string" style="color:#e3116c">'adapter'</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#e3116c">'file'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$this</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token property" style="color:#36acaa">cache</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string single-quoted-string" style="color:#e3116c">'fb_lists'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token variable" style="color:#36acaa">$this</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token property" style="color:#36acaa">cache</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">save</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string single-quoted-string" style="color:#e3116c">'fb_lists'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#e3116c">'1'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3600</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Таким образом мы записываемся в кэш о том, что мы стартовали вгрузку данных в БД. И следующая задача по загрузке гео базы, которая стартует через минуту, уже не запустится.</p><p><strong>Но что, если кэш не работает в данный момент как функция?</strong> В таком случае крон будет запускать процесс обновления гео базы каждую минуту, так как к началу новой минуты у нас не будет достаточно элементов в нужных таблицах. Это проверяется здесь:</p><div class="codeBlockContainer_I0IT language-php theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-php codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$this</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token property" style="color:#36acaa">db</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">count_all_results</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string single-quoted-string" style="color:#e3116c">'fb_countries'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;=</span><span class="token plain"> </span><span class="token keyword static-context" style="color:#00009f">self</span><span class="token operator" style="color:#393A34">::</span><span class="token constant" style="color:#36acaa">MIN_COUNTRIES_COUNT</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token variable" style="color:#36acaa">$empty_countries</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token constant boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$this</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token property" style="color:#36acaa">db</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">count_all_results</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string single-quoted-string" style="color:#e3116c">'fb_regions'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;=</span><span class="token plain"> </span><span class="token keyword static-context" style="color:#00009f">self</span><span class="token operator" style="color:#393A34">::</span><span class="token constant" style="color:#36acaa">MIN_REGIONS_COUNT</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token variable" style="color:#36acaa">$empty_regions</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token constant boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$this</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token property" style="color:#36acaa">db</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">count_all_results</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string single-quoted-string" style="color:#e3116c">'fb_cities'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;=</span><span class="token plain"> </span><span class="token keyword static-context" style="color:#00009f">self</span><span class="token operator" style="color:#393A34">::</span><span class="token constant" style="color:#36acaa">MIN_CITIES_COUNT</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token variable" style="color:#36acaa">$empty_cities</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token constant boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$this</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token property" style="color:#36acaa">db</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">count_all_results</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string single-quoted-string" style="color:#e3116c">'fb_interests'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;=</span><span class="token plain"> </span><span class="token keyword static-context" style="color:#00009f">self</span><span class="token operator" style="color:#393A34">::</span><span class="token constant" style="color:#36acaa">MIN_INTERESTS_COUNT</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token variable" style="color:#36acaa">$empty_interests</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token constant boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$this</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token property" style="color:#36acaa">db</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">count_all_results</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string single-quoted-string" style="color:#e3116c">'fb_behaviors'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;=</span><span class="token plain"> </span><span class="token keyword static-context" style="color:#00009f">self</span><span class="token operator" style="color:#393A34">::</span><span class="token constant" style="color:#36acaa">MIN_BEHAVIORS_COUNT</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token variable" style="color:#36acaa">$empty_behaviors</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token constant boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$this</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token property" style="color:#36acaa">db</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">count_all_results</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string single-quoted-string" style="color:#e3116c">'fb_demographics'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;=</span><span class="token plain"> </span><span class="token keyword static-context" style="color:#00009f">self</span><span class="token operator" style="color:#393A34">::</span><span class="token constant" style="color:#36acaa">MIN_DEMOGRAPHICS_COUNT</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token variable" style="color:#36acaa">$empty_demographics</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token constant boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$empty_demographics</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$empty_countries</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$empty_regions</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$empty_cities</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$empty_interests</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$empty_behaviors</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$h</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$m</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">13</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ... </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Смотря на содержание таблицы fb_cities (самая крупная таблица, около 150 000 записей), я увидел картинку - данные наполняются, наполняются. Наступает новая минута, и количество записей становится = 0. И наполняется заново.</p><p>Затем отправился смотреть на наличие файлов кэша. Во фреймворке CodeIgniter кэш хранится в директории <code>/var/www/html/new/application/cache</code>. Ее просто не существовало...</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="решение">Решение<a class="hash-link" href="#решение" title="Direct link to heading">​</a></h2><p>В pipeline сборки приложения добавил команды:</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> -p /var/www/html/application/cache </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> -R </span><span class="token number" style="color:#36acaa">777</span><span class="token plain"> /var/www/html/application/cache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> -p /var/www/html/new/application/cache </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> -R </span><span class="token number" style="color:#36acaa">777</span><span class="token plain"> /var/www/html/new/application/cache</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div>]]></content>
        <author>
            <name>Denis Zhitnyakov</name>
            <uri>https://github.com/zhitnyakov</uri>
        </author>
        <category label="dolphin" term="dolphin"/>
        <category label="dolphin-server" term="dolphin-server"/>
        <category label="bugs" term="bugs"/>
        <category label="dolphin-server-bugs" term="dolphin-server-bugs"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Крутые коммиты]]></title>
        <id>cool-commits</id>
        <link href="https://dolphinrucom.github.io/internal-docs/internal-docs/blog/cool-commits"/>
        <updated>2022-04-28T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Я не думаю, что кто-либо станет спорить с тем, что такие коммиты - это хорошо:]]></summary>
        <content type="html"><![CDATA[<p>Я не думаю, что кто-либо станет спорить с тем, что такие коммиты - это хорошо:</p><p><img loading="lazy" alt="1" src="/internal-docs/assets/images/1-ae9d36d45e95a1cc9aeda695ce3501a4.png" width="3104" height="1974" class="img_E7b_"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="vscode">VSCode<a class="hash-link" href="#vscode" title="Direct link to heading">​</a></h2><p>Тут все просто. Мы просто берем <a href="https://marketplace.visualstudio.com/items?itemName=vivaxy.vscode-conventional-commits" target="_blank" rel="noopener noreferrer">это расширение</a>.</p><p>У тебя появится новая кнопка с кружочком рядом со всеми стандартными кнопками Git. Это</p><p><img loading="lazy" alt="2" src="/internal-docs/assets/images/2-c628fb91e7e860bb6511c84debea8617.png" width="614" height="324" class="img_E7b_"></p><p>После ее нажатия расширение проведет тебя по нескольким вопросам:</p><ul><li><strong>Тип коммита. Обязательно.</strong> Самые ходовые позиции - <em>fix, feat, docs, refactor, test</em>.</li><li><strong>Emoji. Обязательно.</strong> Выбери что-то логичное. Например, для фикса бага выбери жука. Если не знаешь, что лучше выбрать - выбери то, что больше всего нравится или что-то рандомное.</li><li><strong>Scope.</strong> Необязательно. Я, честно говоря, даже не знаю для чего это.</li><li><strong>Короткое описание. Обязательно.</strong> Одно предложение. Довольно часто это копипаста из заголовка тикета.</li><li><strong>Подробное описание.</strong> Необязательно. Если есть что сказать здесь - скажи.</li><li><strong>ID тикета, к которому относится коммит. Обязательно.</strong> Просто надо и все :)</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="phpstorm">PHPStorm<a class="hash-link" href="#phpstorm" title="Direct link to heading">​</a></h2><p>Увы, в PHPStorm не обойтись одним плагином. Будем ставить два.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="шаг-1">Шаг 1<a class="hash-link" href="#шаг-1" title="Direct link to heading">​</a></h3><p>Устанавливаем <a href="https://plugins.jetbrains.com/plugin/13477-git-commit-message-helper" target="_blank" rel="noopener noreferrer">первый плагин</a>.</p><p>У тебя появится новая кнопка:</p><p><img loading="lazy" alt="3" src="/internal-docs/assets/images/4-a0648f97998f6f827e89bc1b068b7303.png" width="862" height="740" class="img_E7b_"></p><p>После ее нажатия ты попадаешь в диалог:</p><p><img loading="lazy" alt="2" src="/internal-docs/assets/images/3-9f25bff7d801922421d8b65f5d1b79ed.png" width="1856" height="764" class="img_E7b_"></p><ul><li><strong>Type of change. Обязательно.</strong> Самые ходовые позиции - <em>fix, feat, docs, refactor, test</em>.</li><li><strong>Scope of this change.</strong> Необязательно. Я, честно говоря, даже не знаю для чего это.</li><li><strong>Short description. Обязательно.</strong> Одно предложение. Довольно часто это копипаста из заголовка тикета.</li><li><strong>Long description.</strong> Необязательно. Если есть что сказать здесь - скажи.</li><li><strong>Breaking changes.</strong> Необязательно. Не заполняем.</li><li><strong>Closes issues. Обязательно.</strong> Указываешь ID тикетов.</li></ul><p>Нажимаем кнопку <code>ОК</code>.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="шаг-2">Шаг 2<a class="hash-link" href="#шаг-2" title="Direct link to heading">​</a></h3><p>Устанавливаем <a href="https://plugins.jetbrains.com/plugin/12383-gitmoji-plus-commit-button" target="_blank" rel="noopener noreferrer">второй плагин</a>.</p><p>Этот плагин позволяет добавить в уже сформированное сообщение коммита emoji. После установки плагина у тебя появится новая кнопка:</p><p><img loading="lazy" alt="5" src="/internal-docs/assets/images/5-17182f3c73fcf5381900f1767c0bd2ed.png" width="866" height="738" class="img_E7b_"></p><p>Нажимай ее.</p><p>Далее следует выбрать какой-нибудь Emoji. Не особо важно, какой. Важно, чтобы он был. И делал нашу жизнь более цветной и красивой :)</p><p>В целом можно сказать, что для фиксов багов подойдет emoji жука. Для новых фичей - огонь или молния.</p><p>Если не знаешь, что выбрать, выбери любой.</p>]]></content>
        <author>
            <name>Denis Zhitnyakov</name>
            <uri>https://github.com/zhitnyakov</uri>
        </author>
        <category label="разработка" term="разработка"/>
        <category label="мысли" term="мысли"/>
    </entry>
</feed>